import React, { Component } from 'react';
import LeftBoard from './left/LeftBoard';
import MainBoard from './center/MainBoard';
import * as exploitTypes from '../../models/exploit';
import '../../styles/exploit.scss';
import DatabaseManageDialog from './dialog/DatabaseManageDialog';
import FunctionDialog from './dialog/FunctionDialog';
import OfflineTaskDialog from './dialog/OfflineTaskDialog';
import RealTimeTaskDialog from './dialog/RealTimeTaskDialog';
import ResourceFileDialog from './dialog/ResourceFileDialog';
import TableManageDialog from './dialog/TableManageDialog';
import TemporaryTaskDialog from './dialog/TemporaryTaskDialog';
import WorkFlowDialog from './dialog/WorkFlowDialog';
import {List, Map} from 'immutable';

type propTypes = {
    leftMenu: List<exploitTypes.leftMenu>;
    height: number;
    leftWidth: number ;
    rightWidth: number;
    exploitMouseMoveLeft: (leftWidth: number) => void;
    expandLeftMenu: (leftData: List<exploitTypes.leftData>, leftSwitch: string) => void;
    leftSwitch: string;
    switchLeftMenu: (leftSwitch: string) => void;
    leftDataTree: List<exploitTypes.leftData | {}>;
    boardMap: Map<string, any>;
    activeBoardId: string | null;
    switchBoardMap: (activeBoardId: string, boardData: any ) => void;
    transformX: number;
    flowTransformX: (leftWidth: number) => void;
    switchActiveBoardId: (activeBoardId: string) => void;
    updateBoardMap: (boardMap: Map<string, any>) => void;
};

type stateTypes = {
    isWorkFlow: boolean;
    isOfflineTask: boolean;
    isRealTimeTask: boolean;
    isTemporaryTask: boolean;
    isTableManage: boolean;
    isDatabaseManage: boolean;
    isResourceFile: boolean;
    isFunction: boolean;
};

class ExploitBoard extends Component<propTypes, stateTypes> {

    constructor(props: propTypes) {
        super(props);
        this.state = {isWorkFlow: false, isOfflineTask: false, isRealTimeTask: false, isTemporaryTask: false, isTableManage: false, isDatabaseManage: false, isResourceFile: false, isFunction: false};
    }

    changeOpen = (stateName: string, isOpen: boolean ) => {
            // @ts-ignore
        this.setState({[stateName]: isOpen});
    };

    render() {
        const {leftMenu, height, leftWidth, rightWidth, exploitMouseMoveLeft, leftSwitch, switchLeftMenu, leftDataTree, expandLeftMenu, boardMap, activeBoardId, switchBoardMap, transformX, flowTransformX, switchActiveBoardId, updateBoardMap} = this.props;
        const {isWorkFlow, isOfflineTask, isRealTimeTask, isTemporaryTask, isTableManage, isDatabaseManage, isResourceFile, isFunction } = this.state;
        return (
            <div>
                <LeftBoard {...{expandLeftMenu, leftMenu, height, leftWidth, exploitMouseMoveLeft, leftSwitch, switchLeftMenu, leftDataTree, boardMap, switchBoardMap, switchActiveBoardId, updateBoardMap}}  changeOpen={this.changeOpen} />
                <MainBoard {...{leftWidth, rightWidth, height, boardMap, activeBoardId, flowTransformX, transformX, switchActiveBoardId, updateBoardMap}} changeOpen={this.changeOpen} />
                <DatabaseManageDialog isOpen={isDatabaseManage} changeOpen={this.changeOpen} />
                <FunctionDialog isOpen={isFunction} changeOpen={this.changeOpen} />
                <OfflineTaskDialog isOpen={isOfflineTask} changeOpen={this.changeOpen} />
                <RealTimeTaskDialog isOpen={isRealTimeTask} changeOpen={this.changeOpen} />
                <ResourceFileDialog isOpen={isResourceFile} changeOpen={this.changeOpen} />
                <TableManageDialog isOpen={isTableManage} changeOpen={this.changeOpen} />
                <TemporaryTaskDialog isOpen={isTemporaryTask} changeOpen={this.changeOpen} />
                <WorkFlowDialog isOpen={isWorkFlow} changeOpen={this.changeOpen} />
            </div>);
    }
}
export default ExploitBoard;
